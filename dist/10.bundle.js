(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{127:function(t,e,s){},128:function(t,e,s){},317:function(t,e,s){"use strict";var i=s(128);s.n(i).a},433:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[s("div",{staticClass:"edit"},[s("div",{staticClass:"edit--button--wrapper"},[s("button",{directives:[{name:"show",rawName:"v-show",value:!t.quillShow,expression:"!quillShow"}],staticClass:"edit--button-add-New",attrs:{title:"Добавить новую запись"},on:{click:function(e){return t.preparePost("Текст новости")}}},[s("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}},[t._v("  Новою запись")])]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.quillShow,expression:"quillShow"}],staticClass:"edit--button-post",attrs:{title:"Опубликовать"},on:{click:t.addPost}},[t._v("Опубликовать")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.quillShow,expression:"quillShow"}]},[s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newPost.header,expression:"newPost.header"}],staticClass:"edit--input-header",attrs:{type:"text",placeholder:"Заголовок новости"},domProps:{value:t.newPost.header},on:{input:function(e){e.target.composing||t.$set(t.newPost,"header",e.target.value)}}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.quillShow,expression:"quillShow"}],staticClass:"card",attrs:{id:"editor-container"}}),t._v(" "),s("div",{staticClass:"edit--tags"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.newPost.tag,expression:"newPost.tag"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.newPost,"tag",e.target.multiple?s:s[0])}}},t._l(this.$store.state.tags,function(e){return s("option",[t._v("\n                "+t._s(e)+"\n              ")])}),0)])])]),t._v(" "),s("br"),t._v(" "),t._l(t.returndNews,function(e){return s("div",[s("article",{staticClass:"card"},[s("div",{staticClass:"card--header"},[t._v(t._s(e.header)+" \n          "),s("button",{staticClass:"card--header--select",on:{click:function(e){return t.showingEdit()}}},[s("i",{staticClass:"fa fa-pencil-square-o",attrs:{"aria-hidden":"true"}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showEdit,expression:"showEdit"}],staticClass:"card--button__wraper"},[s("button",{staticClass:"card--button card--button__del",on:{click:function(s){return t.delPost(e._id)}}},[t._v("Удалить")]),t._v(" "),s("button",{staticClass:"card--button card--button__edit",on:{click:function(s){return t.editPost(e._id)}}},[t._v("Редактировать")])])]),t._v(" "),s("div",{staticClass:"card--content"},[s("span",{domProps:{innerHTML:t._s(e.content)}})]),t._v(" "),s("div",{staticClass:"card--footer"},[s("div",{staticClass:"card--footer--tag"},[t._v(t._s(e.tag))]),t._v(" "),s("div",{staticClass:"card--footer--date"},[t._v(t._s(e.date))]),t._v(" "),s("div",{staticClass:"card--footer--author"},[t._v(t._s(e.author))])])])])})],2)};i._withStripped=!0;var o=s(126),n=s.n(o);s(127);var a={name:"News",data:()=>({quillShow:!1,isEditCreate:!1,newPostContent:"",newPost:{},showEdit:!1,dateOpt:{year:"numeric",month:"long",day:"numeric",weekday:"long",timezone:"UTC",hour:"numeric",minute:"numeric",second:"numeric"}}),computed:{returndNews:function(){return this.$store.getters.getNews.reverse()}},methods:{preparePost:function(t){this.quillShow=!0;!1===this.isEditCreate&&(this.newPostContent=(e=>{const s=document.getElementById(e);return new n.a(s,{modules:{toolbar:{container:[[{header:[1,2,3,!1]}],["bold","italic","color","underline"],["blockquote","align","formula"],["image","video","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],["clean"]]}},placeholder:t,theme:"snow"})})("editor-container"),this.isEditCreate=!0)},addPost:function(){this.quillShow=!1;this.newPost.content=this.newPostContent.root.innerHTML,this.newPost.date=(new Date).toLocaleString("ru",this.dateOpt),this.newPost.author=this.$store.state.user,"<p><br></p>"===this.newPostContent.root.innerHTML||void 0===this.newPost.header||void 0===this.newPost.tag?alert("Заполните все данные для публикации новости"):(this.$socket.emit("addPost",[this.newPost,"news"]),alert("Новость добавлена")),this.showEdit=!1},delPost:function(t){console.log(t),this.$socket.emit("delPost",[t,"news"]),this.$store.commit("delNews",t),this.showEdit=!1},editPost:function(t){this.$socket.emit("getPost",[t,"news"]),this.preparePost("Загрузка содержимого..."),setTimeout(()=>{this.newPost.content=this.$store.state.returnNews[0].content,this.newPost._id=this.$store.state.returnNews[0]._id,this.newPost.header=this.$store.state.returnNews[0].header,this.newPost.tag=this.$store.state.returnNews[0].tag,this.newPostContent.root.innerHTML=this.newPost.content,this.showEdit=!1},2e3)},showingEdit:function(){this.showEdit=!this.showEdit}}},r=(s(317),s(2)),d=Object(r.a)(a,i,[],!1,null,null,null);d.options.__file="src/views/news/News.vue";e.default=d.exports}}]);
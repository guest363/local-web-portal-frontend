(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{109:function(t,e,i){"use strict";var s=i(98);i.n(s).a},110:function(t,e,i){"use strict";var s=i(99);i.n(s).a},119:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.showMachine.loaded?i("div",{staticClass:"wiki-edit--wrapper"},[t.showMachine.article?i("articleWiki",{attrs:{editPost:t.editPost,delPost:t.delPost,wiki:t.returnedWiki,state:t.showMachine}}):t._e(),t._v(" "),i("articleEditing",{directives:[{name:"show",rawName:"v-show",value:t.showMachine.quill,expression:"showMachine.quill"}],attrs:{path:t.$route.params.name,addPost:t.addPost,state:t.showMachine}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showMachine.quill,expression:"showMachine.quill"}],staticClass:"wiki-edit--placeholder"}),t._v(" "),i("articleSideNav",{attrs:{allTags:t.returnedTags,selectedTags:t.newPost.tag,addWikiTag:t.addWikiTag,state:t.showMachine,removeWikiTag:t.removeWikiTag}}),t._v(" "),t.showMachine.newPost?i("noArticle",{attrs:{context:this,state:t.showMachine}}):t._e()],1):t._e()])};s._withStripped=!0;var a=function(t,e){var i=e._c;return i("article",{staticClass:"wiki-edit--card",attrs:{id:"card-content"}},[i("div",{staticClass:"wiki-edit--card--header"},[e._v("\n        "+e._s(e.props.wiki.header)+"\n        "),i("button",{staticClass:"wiki-edit--card--header--select",on:{click:function(t){return e.props.state.editButtonClicked()}}},[i("i",{staticClass:"fa fa-pencil-square-o",attrs:{"aria-hidden":"true"}})]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.props.state.editButtons,expression:"props.state.editButtons"}],staticClass:"wiki-edit--card--button__wraper"},[i("button",{staticClass:"wiki-edit--card--button wiki-edit--card--button__del",on:{click:function(t){return e.props.delPost(e.props.wiki._id)}}},[e._v("Удалить")]),e._v(" "),i("button",{staticClass:"wiki-edit--card--button wiki-edit--card--button__edit",on:{click:function(t){return e.props.editPost(e.props.wiki.url)}}},[e._v("Редактировать")]),e._v(" "),i("button",{staticClass:"wiki-edit--card--button",on:{click:function(t){return e.props.state.opening()}}},[e._v("Отмена")])])]),e._v(" "),i("div",{staticClass:"wiki-edit--card--content",attrs:{id:"content"}},[i("span",{domProps:{innerHTML:e._s(e.props.wiki.content)}})]),e._v(" "),i("div",{staticClass:"wiki-edit--card--footer"},[i("div",{staticClass:"wiki-edit--card--footer--tags"},e._l(e.props.wiki.tag[0].split(","),(function(t){return i("div",{key:t,staticClass:"wiki-edit--card--footer--tags--tag"},[e._v(e._s(t))])})),0),e._v(" "),i("div",{staticClass:"wiki-edit--card--footer--date"},[e._v(e._s(e.props.wiki.date))])])])};a._withStripped=!0;var n=i(2),r=Object(n.a)({},a,[],!0,null,null,null);r.options.__file="src/moduleWiki/views/cards/article.vue";var o=r.exports,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wiki-edit--card"},[i("div",{staticClass:"edit"},[i("div",{staticClass:"edit---wrapper"},[i("div",[i("h2",{staticClass:"edit--input-header"},[t._v('Запись будет называться - " '+t._s(t.$route.params.name)+' "')])]),t._v(" "),i("div",{ref:"quill",staticClass:"card",attrs:{id:"editor-container"}}),t._v(" "),i("div",{staticClass:"edit--button--wrapper"},[i("button",{staticClass:"edit--button-post button--del",attrs:{title:"Отмена"},on:{click:t.cansel}},[t._v("Отмена")]),t._v(" "),i("button",{staticClass:"edit--button-post button--add",attrs:{title:"Опубликовать"},on:{click:t.addPost}},[t._v("Опубликовать")])])])])])};d._withStripped=!0;var c={props:{state:Object,addPost:Function},methods:{cansel(){this.state.opening(),this.$refs.quill.innerHTML=""}}},l=Object(n.a)(c,d,[],!1,null,null,null);l.options.__file="src/moduleWiki/views/cards/article-editing.vue";var h=l.exports,u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.state.sideNavi?i("side-navi",{attrs:{data:{sourceID:"content"}}}):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.state.sideNavi&&!t.state.newPost,expression:"!state.sideNavi && !state.newPost"}],staticClass:"edit--tags__wrapper"},[i("h2",[t._v("Теги:")]),t._v(" "),i("input",{staticClass:"edit--cloud--tags",attrs:{type:"text",placeholder:"По клавише enter добавить к статье",autocomplete:"on",list:"tagList",spellcheck:"true"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendNewTag(e.target)}}}),t._v(" "),i("datalist",{attrs:{id:"tagList"}},t._l(t.allTags,(function(e){return i("option",{key:e},[t._v(t._s(e))])})),0),t._v(" "),i("div",{staticClass:"edit--tags"},t._l(t.selectedTags,(function(e){return i("div",{key:e,staticClass:"edit--tags--tag",on:{click:function(i){return t.removeTag(e)}}},[t._v(t._s(e))])})),0)])],1)};u._withStripped=!0;var v=function(){var t=this.$createElement;this._self._c;return this._m(0)};v._withStripped=!0;var p={name:"sideChapter",props:["data"],data:()=>({}),methods:{makeMenu:function(){let t=document.getElementById(this.data.sourceID).querySelectorAll("h1, h2, h3, h4, h5, h6");const e=document.getElementById("addingElement"),i=document.createDocumentFragment();t=Array.prototype.slice.call(t);t.reduce((t,e)=>(((t,e)=>{t.setAttribute("id",`C${e}`);let s=document.createElement("li"),a=document.createElement("a");a.title="Навигация",a.innerHTML=`<${t.tagName}> ${t.textContent} </${t.tagName}> `,a.href=`#C${e}`,s.appendChild(a),i.appendChild(s)})(e,t),t+1),0),e.innerHTML="",e.appendChild(i)}},mounted(){this.makeMenu()}},w=(i(109),Object(n.a)(p,v,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content"},[e("h4",{attrs:{id:"content--header"}},[this._v("Содержание:")]),this._v(" "),e("ul",{attrs:{id:"addingElement"}},[e("li",[this._v("Загрузка содержания")])])])}],!1,null,"5753e1ef",null));w.options.__file="src/components/common/makeSideNavi.vue";var _={components:{"side-navi":w.exports},data:()=>({selected:[]}),props:{state:Object,allTags:Array,selectedTags:[Set,Array],addWikiTag:Function,removeWikiTag:Function},methods:{updateSelected(){this.selected="",this.selected=this.selectedTags},sendNewTag(t){this.addWikiTag(t.value),t.value="",this.updateSelected()},removeTag(t){this.removeWikiTag(t),this.updateSelected()}},mounted(){this.updateSelected()}},k=Object(n.a)(_,u,[],!1,null,null,null);k.options.__file="src/moduleWiki/views/cards/article-side-nav.vue";var m=k.exports,g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wiki-edit--card"},[i("div",[i("h2",{staticClass:"wiki-edit--card--header"},[t._v("Запись отсутствует, хотите добавить?")]),t._v(" "),i("button",{on:{click:t.createQuill}},[t._v("Добавить")]),t._v(" "),i("button",{on:{click:function(e){return t.$router.push("/wiki")}}},[t._v("Отмена")])])])};g._withStripped=!0;var f=i(103),C=i.n(f);i(95);var T=function(t,e){t.newPostContent=(t=>{const e=document.getElementById(t);if(void 0===e)return void alert("Ошибка в форматировании страницы");e.innerHTML='<div id="editor-container" class="card"></div>';const i=document.getElementById("editor-container");return new C.a(i,{modules:{toolbar:{container:[[{header:[1,2,3,4,!1]}],["bold","italic","color","underline"],["blockquote","align","formula"],[{color:[]},{background:[]}],["link","image","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}]]}},theme:"snow"})})(e)},b={props:{state:Object,context:Object},methods:{createQuill(){this.state.editing(),T(this.context,"editor-container")}}},P=Object(n.a)(b,g,[],!1,null,null,null);P.options.__file="src/moduleWiki/views/cards/no-article.vue";var W=P.exports,M={editButtons:!1,quill:!1,addBlock:!1,sideNavi:!1,article:!1,newPost:!1,loaded:!1,stateSetter:function(t,e,i,s,a,n=!1){this.editButtons=t,this.quill=e,this.addBlock=i,this.sideNavi=s,this.article=a,this.newPost=n},noArticle:function(){return this.stateSetter(!1,!1,!1,!1,!1,!0),this},opening:function(){return this.stateSetter(!1,!1,!1,!0,!0),this},editing:function(){return this.stateSetter(!1,!0,!1,!1,!1),this},editButtonClicked:function(){return this.stateSetter(!0,!1,!1,!0,!0),this},loadedFinished(){return this.loaded=!0,this},closeWiki(){return this.loaded=!1,this}};var $={name:"WikiAdd",components:{articleWiki:o,articleEditing:h,articleSideNav:m,noArticle:W},data:()=>({showMachine:"",newPostContent:"",newTag:"",newPost:{content:"",date:"",url:"",header:"",tag:new Set}}),methods:{noContent(){this.$store.commit("SET_ALERT_MSG",{header:"Ошибка",text:"Заполните все данные для публикации статьи"},{root:!0}),this.$store.commit("SHOW_ALERT",{root:!0}),this.showMachine.editing()},async hasContent(){this.newPost.content=this.newPostContent.root.innerHTML,this.newPost.url=this.$route.params.name,this.newPost.date=Date.now(),this.newPost.header=this.$route.params.name,this.newPost.tag=[...this.newPost.tag];await this.$store.dispatch("ADD_WIKI",this.newPost);await this.$store.dispatch("GET_WIKI",this.$route.path),this.hasArticle()},addPost(){"<p><br></p>"===this.newPostContent.root.innerHTML?this.noContent():this.hasContent()},delPost:function(t){this.$store.dispatch("DELETE_WIKI",t),this.showMachine.opening()},editPost:function(){this.showMachine.editing(),T(this,"editor-container"),this.newPost.content=this.returnedWiki.content,this.newPost.header=this.returnedWiki.header,this.newPostContent.root.innerHTML=this.newPost.content},async addWikiTag(t){""!==t&&this.newPost.tag.add(t.toUpperCase())},removeWikiTag(t){this.newPost.tag.delete(t)},async hasArticle(){this.showMachine.opening(),await this.$store.dispatch("GET_WIKI",this.$route.params.name),this.returnedWiki.tag=void 0===this.returnedWiki.tag[0]?["Без тега"]:this.returnedWiki.tag,this.newPost.tag=new Set(this.returnedWiki.tag)},noArticle(){this.showMachine.noArticle()}},computed:{returnedWiki(){return this.$store.getters.GET_WIKI},returnedTags(){return this.$store.getters.GET_TAGS}},async created(){this.showMachine=M,await this.$store.dispatch("GET_WIKI",this.$route.params.name),void 0===this.returnedWiki.content?this.noArticle():this.hasArticle(),this.$store.dispatch("GET_TAGS",this.$route.params.name),this.showMachine.loadedFinished()},beforeDestroy(){this.showMachine.closeWiki()}},E=(i(94),i(110),Object(n.a)($,s,[],!1,null,null,null));E.options.__file="src/moduleWiki/views/wiki-add.vue";e.default=E.exports},91:function(t,e,i){},94:function(t,e,i){"use strict";var s=i(91);i.n(s).a},95:function(t,e,i){},98:function(t,e,i){},99:function(t,e,i){}}]);